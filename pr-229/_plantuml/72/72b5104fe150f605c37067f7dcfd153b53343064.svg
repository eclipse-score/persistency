<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="554px" preserveAspectRatio="none" style="width:661px;height:554px;background:#FFFFFF;" version="1.1" viewBox="0 0 661 554" width="661px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="542.9922" style="stroke:#181818;stroke-width:0.5;" width="251.8145" x="386.3164" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.4873" x="456.98" y="18.0669">score::mw::per</text><rect fill="transparent" height="185.6016" style="stroke:#000000;stroke-width:1.5;" width="573.1309" x="81" y="266.0938"/><rect fill="transparent" height="104.5313" style="stroke:#000000;stroke-width:1.5;" width="532.1309" x="112" y="290.2266"/><g><title>User App</title><rect fill="transparent" height="386.3984" width="8" x="152.8555" y="82.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="156" x2="156" y1="82.2969" y2="468.6953"/></g><g><title>Frontend</title><rect fill="transparent" height="386.3984" width="8" x="424.8711" y="82.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="428.3164" x2="428.3164" y1="82.2969" y2="468.6953"/></g><g><title>Backend</title><rect fill="transparent" height="386.3984" width="8" x="592.9502" y="82.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="596.7695" x2="596.7695" y1="82.2969" y2="468.6953"/></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.7109" x="122" y="78.9951">User App</text><ellipse cx="156.8555" cy="21.5" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;"/><path d="M156.8555,41.5 C160.8555,41.5 163.8555,41.5 167.8555,37.5 C175.8555,37.5 183.8555,45.5 183.8555,53.5 L183.8555,57.5 C183.8555,61.5 179.8555,65.5 175.8555,65.5 L137.8555,65.5 C133.8555,65.5 129.8555,61.5 129.8555,57.5 L129.8555,53.5 C129.8555,45.5 137.8555,37.5 145.8555,37.5 C149.8555,41.5 152.8555,41.5 156.8555,41.5 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.7109" x="122" y="480.6904">User App</text><ellipse cx="156.8555" cy="500.4922" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;"/><path d="M156.8555,520.4922 C160.8555,520.4922 163.8555,520.4922 167.8555,516.4922 C175.8555,516.4922 183.8555,524.4922 183.8555,532.4922 L183.8555,536.4922 C183.8555,540.4922 179.8555,544.4922 175.8555,544.4922 L137.8555,544.4922 C133.8555,544.4922 129.8555,540.4922 129.8555,536.4922 L129.8555,532.4922 C129.8555,524.4922 137.8555,516.4922 145.8555,516.4922 C149.8555,520.4922 152.8555,520.4922 156.8555,520.4922 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.1094" x="390.3164" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.1094" x="397.3164" y="70.9951">Frontend</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.1094" x="390.3164" y="467.6953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.1094" x="397.3164" y="487.6904">Frontend</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74.3613" x="559.7695" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.3613" x="566.7695" y="70.9951">Backend</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74.3613" x="559.7695" y="467.6953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.3613" x="566.7695" y="487.6904">Backend</text><polygon fill="#181818" points="416.8711,109.4297,426.8711,113.4297,416.8711,117.4297,420.8711,113.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="156.8555" x2="422.8711" y1="113.4297" y2="113.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.4395" x="163.8555" y="108.3638">KvsBuilder(instance_id: InstanceId)</text><polygon fill="#181818" points="584.9502,138.5625,594.9502,142.5625,584.9502,146.5625,588.9502,142.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="428.8711" x2="590.9502" y1="142.5625" y2="142.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6929" x="435.8711" y="137.4966">load_kvs(1)</text><polygon fill="#181818" points="439.8711,167.6953,429.8711,171.6953,439.8711,175.6953,435.8711,171.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="433.8711" x2="595.9502" y1="171.6953" y2="171.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.2017" x="445.8711" y="166.6294">Error</text><polygon fill="#181818" points="167.8555,196.8281,157.8555,200.8281,167.8555,204.8281,163.8555,200.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="161.8555" x2="427.8711" y1="200.8281" y2="200.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.2578" x="173.8555" y="195.7622">kvs.has_value()</text><path d="M5,213.8281 L5,253.8281 L308,253.8281 L308,223.8281 L298,213.8281 L5,213.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M298,213.8281 L298,223.8281 L308,223.8281 L298,213.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.9941" x="11" y="230.895">Do we have to return value in error case?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282.9023" x="11" y="246.0278">Just enable call of snapshot_restore() later?</text><path d="M81,266.0938 L145.4429,266.0938 L145.4429,273.2266 L135.4429,283.2266 L81,283.2266 L81,266.0938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="185.6016" style="stroke:#000000;stroke-width:1.5;" width="573.1309" x="81" y="266.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="96" y="279.1606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="263.8281" x="160.4429" y="278.3042">[Recoverable error  (eg. ValidationFailed)]</text><path d="M112,290.2266 L188.624,290.2266 L188.624,297.3594 L178.624,307.3594 L112,307.3594 L112,290.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="104.5313" style="stroke:#000000;stroke-width:1.5;" width="532.1309" x="112" y="290.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="127" y="303.2935">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="311.7705" x="203.624" y="302.437">[until valid snapshot found or no more snapshots]</text><polygon fill="#181818" points="416.8711,324.4922,426.8711,328.4922,416.8711,332.4922,420.8711,328.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="156.8555" x2="422.8711" y1="328.4922" y2="328.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.0156" x="163.8555" y="323.4263">kvs.snapshot_restore(shapshot_id++)</text><polygon fill="#181818" points="584.9502,353.625,594.9502,357.625,584.9502,361.625,588.9502,357.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="428.8711" x2="590.9502" y1="357.625" y2="357.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.0791" x="435.8711" y="352.5591">load_kvs(shapshot_id)</text><polygon fill="#181818" points="439.8711,382.7578,429.8711,386.7578,439.8711,390.7578,435.8711,386.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="433.8711" x2="595.9502" y1="386.7578" y2="386.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.4258" x="445.8711" y="381.6919">KvsMap</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="81" x2="654.1309" y1="402.7578" y2="402.7578"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="245.0024" x="86" y="412.9683">[Non recoverable error (eg. disk error)]</text><path d="M91,421.5625 L91,446.5625 L221,446.5625 L221,431.5625 L211,421.5625 L91,421.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M211,421.5625 L211,431.5625 L221,431.5625 L211,421.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.2749" x="97" y="438.6294">Error handling ...</text><!--SRC=[TL9DQzj04BtlhtZeP1CYw5MK13iVu8O6qzAU2cQYdSIBrxjYPoMd_xwpifeOXnntvdtelP7iNEWeqHxKvfX-vh-UGGUMk6TZnXcgNy89YwwhG8B5UcsUuYigQMFYfjaVcgRZL1b0XR9hNKSXexfFCMGETYAjplTBQdV_ryl5pSFTuwtHDrJR63N1vLMXDNWOPDaxRpdDN91CeUMDimrMqsDbvufV5Voaqy17iflT8BClnztNo_VTNKenZGuw7HqKM6z9DWFvdcTp4s9cnA64NgyRt4OS65iQ63aYSUvJm8Y52-0YXvQ4h_-4RxraSA0dRR4bxn6V8O4wsSQyIInQfnh0K-PqRSXd_E2sE8sCenHc_5BZDtbdARiOxibvrepGLB537xBpnTxPDsaynrwhKtA8sAl7sqQK1fpMMS9- -2JPJWDdBoxc4-UJIa-mxyZJWlLWtwdJbPxJi1V6OmpQstdGCQTriZk-YzXPy-EfjFbWlGilgEkw_2B_0000]--></g></svg>