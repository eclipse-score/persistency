<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1137px" preserveAspectRatio="none" style="width:749px;height:1137px;background:#FFFFFF;" version="1.1" viewBox="0 0 749 1137" width="749px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="1125.9844" style="stroke:#181818;stroke-width:0.5;" width="388.6001" x="347.6216" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110.4873" x="486.678" y="18.0669">score::mw::per</text><rect fill="transparent" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="400.6001" x="341.6216" y="128.4297"/><rect fill="transparent" height="223.7969" style="stroke:#000000;stroke-width:1.5;" width="732.2217" x="10" y="391.2969"/><rect fill="transparent" height="204.7969" style="stroke:#000000;stroke-width:1.5;" width="732.2217" x="10" y="729.4922"/><g><title>User App</title><rect fill="transparent" height="969.3906" width="8" x="50.8555" y="82.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="54" x2="54" y1="82.2969" y2="1051.6875"/></g><g><title>Frontend</title><rect fill="transparent" height="969.3906" width="8" x="386.1763" y="82.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="389.6216" x2="389.6216" y1="82.2969" y2="1051.6875"/></g><g><title>Backend</title><rect fill="transparent" height="969.3906" width="8" x="691.041" y="82.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="694.8604" x2="694.8604" y1="82.2969" y2="1051.6875"/></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.7109" x="20" y="78.9951">User App</text><ellipse cx="54.8555" cy="21.5" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;"/><path d="M54.8555,41.5 C58.8555,41.5 61.8555,41.5 65.8555,37.5 C73.8555,37.5 81.8555,45.5 81.8555,53.5 L81.8555,57.5 C81.8555,61.5 77.8555,65.5 73.8555,65.5 L35.8555,65.5 C31.8555,65.5 27.8555,61.5 27.8555,57.5 L27.8555,53.5 C27.8555,45.5 35.8555,37.5 43.8555,37.5 C47.8555,41.5 50.8555,41.5 54.8555,41.5 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.7109" x="20" y="1063.6826">User App</text><ellipse cx="54.8555" cy="1083.4844" fill="#E2E2F0" rx="16" ry="16" style="stroke:#181818;stroke-width:0.5;"/><path d="M54.8555,1103.4844 C58.8555,1103.4844 61.8555,1103.4844 65.8555,1099.4844 C73.8555,1099.4844 81.8555,1107.4844 81.8555,1115.4844 L81.8555,1119.4844 C81.8555,1123.4844 77.8555,1127.4844 73.8555,1127.4844 L35.8555,1127.4844 C31.8555,1127.4844 27.8555,1123.4844 27.8555,1119.4844 L27.8555,1115.4844 C27.8555,1107.4844 35.8555,1099.4844 43.8555,1099.4844 C47.8555,1103.4844 50.8555,1103.4844 54.8555,1103.4844 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.1094" x="351.6216" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.1094" x="358.6216" y="70.9951">Frontend</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.1094" x="351.6216" y="1050.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.1094" x="358.6216" y="1070.6826">Frontend</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74.3613" x="657.8604" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.3613" x="664.8604" y="70.9951">Backend</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74.3613" x="657.8604" y="1050.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60.3613" x="664.8604" y="1070.6826">Backend</text><polygon fill="#181818" points="378.1763,109.4297,388.1763,113.4297,378.1763,117.4297,382.1763,113.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="54.8555" x2="384.1763" y1="113.4297" y2="113.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311.3208" x="61.8555" y="108.3638">KvsBuilder(instance_id: InstanceId, SnapshotID)</text><path d="M341.6216,128.4297 L406.0645,128.4297 L406.0645,135.5625 L396.0645,145.5625 L341.6216,145.5625 L341.6216,128.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="400.6001" x="341.6216" y="128.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="356.6216" y="141.4966">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="187.8433" x="421.0645" y="140.6401">[Write transaction completed]</text><polygon fill="#181818" points="683.041,162.6953,693.041,166.6953,683.041,170.6953,687.041,166.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="390.1763" x2="689.041" y1="166.6953" y2="166.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.3701" x="397.1763" y="161.6294">load_last_kvs()</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="341.6216" x2="742.2217" y1="175.6953" y2="175.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="194.0737" x="346.6216" y="185.9058">[Write transaction interrupted]</text><polygon fill="#181818" points="683.041,206.6328,693.041,210.6328,683.041,214.6328,687.041,210.6328" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="390.1763" x2="689.041" y1="210.6328" y2="210.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.7876" x="397.1763" y="205.5669">load_previous_kvs()</text><polygon fill="#181818" points="401.1763,242.7656,391.1763,246.7656,401.1763,250.7656,397.1763,246.7656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="395.1763" x2="694.041" y1="246.7656" y2="246.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.4258" x="407.1763" y="241.6997">KvsMap</text><polygon fill="#181818" points="65.8555,271.8984,55.8555,275.8984,65.8555,279.8984,61.8555,275.8984" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="59.8555" x2="389.1763" y1="275.8984" y2="275.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.2578" x="71.8555" y="270.8325">kvs.has_value()</text><polygon fill="#181818" points="378.1763,301.0313,388.1763,305.0313,378.1763,309.0313,382.1763,305.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="54.8555" x2="384.1763" y1="305.0313" y2="305.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.4478" x="61.8555" y="299.9653">get_value(key: Key)</text><line style="stroke:#181818;stroke-width:1;" x1="390.1763" x2="432.1763" y1="334.1641" y2="334.1641"/><line style="stroke:#181818;stroke-width:1;" x1="432.1763" x2="432.1763" y1="334.1641" y2="347.1641"/><line style="stroke:#181818;stroke-width:1;" x1="391.1763" x2="432.1763" y1="347.1641" y2="347.1641"/><polygon fill="#181818" points="401.1763,343.1641,391.1763,347.1641,401.1763,351.1641,397.1763,347.1641" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.6514" x="397.1763" y="329.0981">Value = KvsMap[Key]</text><polygon fill="#181818" points="65.8555,372.2969,55.8555,376.2969,65.8555,380.2969,61.8555,376.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="59.8555" x2="389.1763" y1="376.2969" y2="376.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36.7085" x="71.8555" y="371.231">Value</text><path d="M10,391.2969 L136.1992,391.2969 L136.1992,398.4297 L126.1992,408.4297 L10,408.4297 L10,391.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="223.7969" style="stroke:#000000;stroke-width:1.5;" width="732.2217" x="10" y="391.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.1992" x="25" y="404.3638">SW Update</text><polygon fill="#181818" points="378.1763,425.5625,388.1763,429.5625,378.1763,433.5625,382.1763,429.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="54.8555" x2="384.1763" y1="429.5625" y2="429.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.1743" x="61.8555" y="424.4966">create_snapshot("Before update")</text><polygon fill="#181818" points="683.041,454.6953,693.041,458.6953,683.041,462.6953,687.041,458.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="390.1763" x2="689.041" y1="458.6953" y2="458.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280.8647" x="397.1763" y="453.6294">create_snapshot(KvsMap, "Before update")</text><polygon fill="#181818" points="401.1763,468.6953,391.1763,472.6953,401.1763,476.6953,397.1763,472.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="395.1763" x2="694.041" y1="472.6953" y2="472.6953"/><polygon fill="#181818" points="65.8555,482.6953,55.8555,486.6953,65.8555,490.6953,61.8555,486.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="59.8555" x2="389.1763" y1="486.6953" y2="486.6953"/><polygon fill="#181818" points="378.1763,511.8281,388.1763,515.8281,378.1763,519.8281,382.1763,515.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="54.8555" x2="384.1763" y1="515.8281" y2="515.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.3179" x="61.8555" y="510.7622">set_value(key: Key, value: NewValue)</text><line style="stroke:#181818;stroke-width:1;" x1="390.1763" x2="432.1763" y1="544.9609" y2="544.9609"/><line style="stroke:#181818;stroke-width:1;" x1="432.1763" x2="432.1763" y1="544.9609" y2="557.9609"/><line style="stroke:#181818;stroke-width:1;" x1="391.1763" x2="432.1763" y1="557.9609" y2="557.9609"/><polygon fill="#181818" points="401.1763,553.9609,391.1763,557.9609,401.1763,561.9609,397.1763,557.9609" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0063" x="397.1763" y="539.895">KvsMap[Key] = NewValue</text><polygon fill="#181818" points="65.8555,567.9609,55.8555,571.9609,65.8555,575.9609,61.8555,571.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="59.8555" x2="389.1763" y1="571.9609" y2="571.9609"/><path d="M20,584.9609 L20,609.9609 L423,609.9609 L423,594.9609 L413,584.9609 L20,584.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M413,584.9609 L413,594.9609 L423,594.9609 L413,584.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.397" x="211.167" y="602.0278">...</text><polygon fill="#181818" points="378.1763,639.2266,388.1763,643.2266,378.1763,647.2266,382.1763,643.2266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="54.8555" x2="384.1763" y1="643.2266" y2="643.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.4478" x="61.8555" y="638.1606">get_value(key: Key)</text><line style="stroke:#181818;stroke-width:1;" x1="390.1763" x2="432.1763" y1="672.3594" y2="672.3594"/><line style="stroke:#181818;stroke-width:1;" x1="432.1763" x2="432.1763" y1="672.3594" y2="685.3594"/><line style="stroke:#181818;stroke-width:1;" x1="391.1763" x2="432.1763" y1="685.3594" y2="685.3594"/><polygon fill="#181818" points="401.1763,681.3594,391.1763,685.3594,401.1763,689.3594,397.1763,685.3594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.0063" x="397.1763" y="667.2935">NewValue = KvsMap[Key]</text><polygon fill="#181818" points="65.8555,710.4922,55.8555,714.4922,65.8555,718.4922,61.8555,714.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="59.8555" x2="389.1763" y1="714.4922" y2="714.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.0635" x="71.8555" y="709.4263">NewValue</text><path d="M10,729.4922 L203.0083,729.4922 L203.0083,736.625 L193.0083,746.625 L10,746.625 L10,729.4922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="204.7969" style="stroke:#000000;stroke-width:1.5;" width="732.2217" x="10" y="729.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="148.0083" x="25" y="742.5591">SW Update Rollback</text><polygon fill="#181818" points="378.1763,763.7578,388.1763,767.7578,378.1763,771.7578,382.1763,767.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="54.8555" x2="384.1763" y1="767.7578" y2="767.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.1318" x="61.8555" y="762.6919">restore_snapshot("Before update")</text><polygon fill="#181818" points="683.041,792.8906,693.041,796.8906,683.041,800.8906,687.041,796.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="390.1763" x2="689.041" y1="796.8906" y2="796.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.1318" x="397.1763" y="791.8247">restore_snapshot("Before update")</text><polygon fill="#181818" points="401.1763,822.0234,391.1763,826.0234,401.1763,830.0234,397.1763,826.0234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="395.1763" x2="694.041" y1="826.0234" y2="826.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.4258" x="407.1763" y="820.9575">KvsMap</text><polygon fill="#181818" points="65.8555,836.0234,55.8555,840.0234,65.8555,844.0234,61.8555,840.0234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="59.8555" x2="389.1763" y1="840.0234" y2="840.0234"/><polygon fill="#181818" points="378.1763,865.1563,388.1763,869.1563,378.1763,873.1563,382.1763,869.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="54.8555" x2="384.1763" y1="869.1563" y2="869.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.5776" x="61.8555" y="864.0903">delete_snapshot("Before update")</text><polygon fill="#181818" points="683.041,894.2891,693.041,898.2891,683.041,902.2891,687.041,898.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="390.1763" x2="689.041" y1="898.2891" y2="898.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.5776" x="397.1763" y="893.2231">delete_snapshot("Before update")</text><polygon fill="#181818" points="401.1763,908.2891,391.1763,912.2891,401.1763,916.2891,397.1763,912.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="395.1763" x2="694.041" y1="912.2891" y2="912.2891"/><polygon fill="#181818" points="65.8555,922.2891,55.8555,926.2891,65.8555,930.2891,61.8555,926.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="59.8555" x2="389.1763" y1="926.2891" y2="926.2891"/><polygon fill="#181818" points="378.1763,958.4219,388.1763,962.4219,378.1763,966.4219,382.1763,962.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="54.8555" x2="384.1763" y1="962.4219" y2="962.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.4478" x="61.8555" y="957.356">get_value(key: Key)</text><line style="stroke:#181818;stroke-width:1;" x1="390.1763" x2="432.1763" y1="991.5547" y2="991.5547"/><line style="stroke:#181818;stroke-width:1;" x1="432.1763" x2="432.1763" y1="991.5547" y2="1004.5547"/><line style="stroke:#181818;stroke-width:1;" x1="391.1763" x2="432.1763" y1="1004.5547" y2="1004.5547"/><polygon fill="#181818" points="401.1763,1000.5547,391.1763,1004.5547,401.1763,1008.5547,397.1763,1004.5547" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.6514" x="397.1763" y="986.4888">Value = KvsMap[Key]</text><polygon fill="#181818" points="65.8555,1029.6875,55.8555,1033.6875,65.8555,1037.6875,61.8555,1033.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="59.8555" x2="389.1763" y1="1033.6875" y2="1033.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36.7085" x="71.8555" y="1028.6216">Value</text><!--SRC=[bLFHQXin47pNLoptP8FZ3pZIWjsaO4A2gKdpKCgnkTicmh8a9Dsv_lkk55tjd1DZFqgxCxCpMlcrr1OTRW3hODmgx1G1RicR3GcHxg1uzEHWPcq1w66sN8fdynSANnj7PRdPbgKbLmW09WgobXPrWEAxCpgGRZ9eCQpFiLxtvVdisztjmutWCp2t42m2LryZh8IxpizRgHfo8wbzG5rJ9PiI5lcmQ2QmqcZzgmcBcp7he0hmv6GW20wrPnVIQAZDnYeAr707HEgea9LBK0QRIg4FrRhpeyX2ojC7D99TETVQaqJMKITDw_TaEdR7tkkhVIzRkqURtF9rSik0wIlwgaFL4aFVHV528HVMj6CuxSOYwwVwprY3Bvdt5zT_loDFTV7YJ6jXzGIFji50QQwzHks8BokV4nqLS_h33mrjQYx6ujZo4F8cFu5Fe0S9PEqydnYCue_iJY2TItYWRJ9pC4w_BBrppg7l6iW0QCElQhgurilbv0qwdKxZ0bwMUAzm8lJ_Gmo3Xnz6gMV-1WFRZZn_kykUu5pC1zitpEPmb8RYZpd9UZpBsQ3F5-7YTpXhy_y1]--></g></svg>